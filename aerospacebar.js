let data = {
  name: "Texas",
  imports: {
    name: "Texas",
    data: [
      {
        name: "Coal",
        drilldown: "coal",
        isDrilldown: "False",
        y: 29218687,
      },
      {
        name: "Crude Oil",
        drilldown: "crudeOil",
        isDrilldown: "False",
        y: 4282060548,
      },
      {
        name: "Electricity",
        drilldown: "electricity",
        isDrilldown: "False",
        y: 34297,
      },
      {
        name: "Fuel Ethanol",
        drilldown: "fuelEthanol",
        isDrilldown: "False",
        y: 0,
      },
      {
        name: "Natural Gas",
        drilldown: "naturalGas",
        isDrilldown: "False",
        y: 0,
      },
      {
        name: "RPP",
        drilldown: "rpp",
        isDrilldown: "False",
        y: 876221045,
      },
      {
        name: "Uranium",
        drilldown: "uranium",
        isDrilldown: "False",
        y: 18807432,
      },
    ],
    rankingValues: [6, 2, 20, 10, 3, 6],
  },
  exports: {
    name: "Texas",
    data: [
      {
        name: "Coal",
        drilldown: "coal",
        isDrilldown: "False",
        y: 91670,
      },
      {
        name: "Crude Oil",
        drilldown: "crudeOil",
        isDrilldown: "False",
        y: 5004637188,
      },
      {
        name: "Electricity",
        drilldown: "electricity",
        isDrilldown: "False",
        y: 2684743,
      },
      {
        name: "Fuel Ethanol",
        drilldown: "fuelEthanol",
        isDrilldown: "False",
        y: 10839699,
      },
      {
        name: "Natural Gas",
        drilldown: "naturalGas",
        isDrilldown: "False",
        y: 60001837,
      },
      {
        name: "RPP",
        drilldown: "rpp",
        isDrilldown: "False",
        y: 1610172187,
      },
      {
        name: "Uranium",
        drilldown: "uranium",
        isDrilldown: "False",
        y: 115057,
      },
    ],
    rankingValues: [23, 1, 5, 7, 5, 2, 19],
  },
  importDrilldown: [
    {
      name: "Coal",
      id: "coal",
      data: [
        {
          name: "California",
          y: 75971123,
          color: "#6a041d",
        },
        {
          name: "Indiana",
          y: 58801555,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 54596129,
          color: "#6a041d",
        },
        {
          name: "Ohio",
          y: 44118627,
          color: "#6a041d",
        },
        {
          name: "Pennsylvania",
          y: 43668662,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 29218687,
          color: "#F5B841",
        },
        {
          name: "New York",
          y: 28436682,
          color: "#6a041d",
        },
        {
          name: "West Virginia",
          y: 20516854,
          color: "#6a041d",
        },
        {
          name: "Florida",
          y: 17762224,
          color: "#6a041d",
        },
        {
          name: "Kentucky",
          y: 16994773,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Crude Oil",
      id: "crudeOil",
      data: [
        {
          name: "Illinois",
          y: 19375441935,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 4282060548,
          color: "#F5B841",
        },
        {
          name: "Minnesota",
          y: 3703580859,
          color: "#6a041d",
        },
        {
          name: "Oklahoma",
          y: 3539158765,
          color: "#6a041d",
        },
        {
          name: "West Virginia",
          y: 3448268712,
          color: "#6a041d",
        },
        {
          name: "Montana",
          y: 2381597728,
          color: "#6a041d",
        },
        {
          name: "Missouri",
          y: 2073583673,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 1760785845,
          color: "#6a041d",
        },
        {
          name: "Colorado",
          y: 1752307899,
          color: "#6a041d",
        },
        {
          name: "Louisiana",
          y: 1370480886,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Electricity",
      id: "electricity",
      data: [
        {
          name: "Virginia",
          y: 426738729,
          color: "#6a041d",
        },
        {
          name: "Minnesota",
          y: 411526371,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 340662476,
          color: "#6a041d",
        },
        {
          name: "California",
          y: 338037136,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 159521436,
          color: "#6a041d",
        },
        {
          name: "Maine",
          y: 153011309,
          color: "#6a041d",
        },
        {
          name: "Arizona",
          y: 47732394,
          color: "#6a041d",
        },
        {
          name: "West Virginia",
          y: 46615281,
          color: "#6a041d",
        },
        {
          name: "New Hampshire",
          y: 37946704,
          color: "#6a041d",
        },
        {
          name: "Oregon",
          y: 18210902,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 34297,
          color: "#F5B841",
        },
      ],
    },
    {
      name: "Fuel Ethanol",
      id: "fuelEthanol",
      data: [
        {
          name: "Louisiana",
          y: 55692,
          color: "#6a041d",
        },
        {
          name: "Wyoming",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "Wisconsin",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "West Virginia",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "Washington",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "Virginia",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "Vermont",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "Utah",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "U.S. Virgin Islands",
          y: 0,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 0,
          color: "#F5B841",
        },
      ],
    },
    {
      name: "Natural Gas",
      id: "naturalGas",
      data: [
        {
          name: "West Virginia",
          y: 2519392096,
          color: "#6a041d",
        },
        {
          name: "Illinois",
          y: 875350446,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 672367026,
          color: "#6a041d",
        },
        {
          name: "Massachusetts",
          y: 421972833,
          color: "#6a041d",
        },
        {
          name: "Minnesota",
          y: 302584448,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 289668342,
          color: "#6a041d",
        },
        {
          name: "Iowa",
          y: 112389633,
          color: "#6a041d",
        },
        {
          name: "Montana",
          y: 65586538,
          color: "#6a041d",
        },
        {
          name: "Virginia",
          y: 39659249,
          color: "#6a041d",
        },
        {
          name: "Tennessee",
          y: 12606788,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 0,
          color: "#F5B841",
        },
      ],
    },
    {
      name: "RPP",
      id: "rpp",
      data: [
        {
          name: "Massachusetts",
          y: 1501875074,
          color: "#6a041d",
        },
        {
          name: "Maine",
          y: 1450605351,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 876221045,
          color: "#F5B841",
        },
        {
          name: "Rhode Island",
          y: 622666876,
          color: "#6a041d",
        },
        {
          name: "New Jersey",
          y: 559748096,
          color: "#6a041d",
        },
        {
          name: "West Virginia",
          y: 532117141,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 509868543,
          color: "#6a041d",
        },
        {
          name: "New Hampshire",
          y: 382713251,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 327375260,
          color: "#6a041d",
        },
        {
          name: "Connecticut",
          y: 303864591,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Uranium",
      id: "uranium",
      data: [
        {
          name: "California",
          y: 48833965,
          color: "#6a041d",
        },
        {
          name: "Illinois",
          y: 42873716,
          color: "#6a041d",
        },
        {
          name: "Florida",
          y: 24578009,
          color: "#6a041d",
        },
        {
          name: "Tennessee",
          y: 23310254,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 21272555,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 18807432,
          color: "#F5B841",
        },
        {
          name: "New Jersey",
          y: 18405332,
          color: "#6a041d",
        },
        {
          name: "North Carolina",
          y: 18119727,
          color: "#6a041d",
        },
        {
          name: "Ohio",
          y: 12682510,
          color: "#6a041d",
        },
        {
          name: "Georgia",
          y: 10502377,
          color: "#6a041d",
        },
      ],
    },
  ],
  exportDrilldown: [
    {
      name: "Coal",
      id: "coal",
      data: [
        {
          name: "Pennsylvania",
          y: 209222555,
          color: "#6a041d",
        },
        {
          name: "West Virginia",
          y: 197012794,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 86819961,
          color: "#6a041d",
        },
        {
          name: "Missouri",
          y: 55341692,
          color: "#6a041d",
        },
        {
          name: "Kentucky",
          y: 33854376,
          color: "#6a041d",
        },
        {
          name: "Ohio",
          y: 23704187,
          color: "#6a041d",
        },
        {
          name: "Indiana",
          y: 13367937,
          color: "#6a041d",
        },
        {
          name: "Utah",
          y: 12889504,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 9854357,
          color: "#6a041d",
        },
        {
          name: "Virginia",
          y: 9824628,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 91670,
          color: "#F5B841",
        },
      ],
    },
    {
      name: "Crude Oil",
      id: "crudeOil",
      data: [
        {
          name: "Texas",
          y: 5004637188,
          color: "#F5B841",
        },
        {
          name: "North Dakota",
          y: 1523019057,
          color: "#6a041d",
        },
        {
          name: "Louisiana",
          y: 288547160,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 27062464,
          color: "#6a041d",
        },
        {
          name: "Indiana",
          y: 25721214,
          color: "#6a041d",
        },
        {
          name: "Ohio",
          y: 14580021,
          color: "#6a041d",
        },
        {
          name: "Washington",
          y: 9032884,
          color: "#6a041d",
        },
        {
          name: "Minnesota",
          y: 2798059,
          color: "#6a041d",
        },
        {
          name: "Utah",
          y: 1050353,
          color: "#6a041d",
        },
        {
          name: "Virginia",
          y: 843628,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Electricity",
      id: "electricity",
      data: [
        {
          name: "Washington",
          y: 165953921,
          color: "#6a041d",
        },
        {
          name: "Montana",
          y: 10458780,
          color: "#6a041d",
        },
        {
          name: "Massachusetts",
          y: 4297949,
          color: "#6a041d",
        },
        {
          name: "Indiana",
          y: 3929552,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 2684743,
          color: "#F5B841",
        },
        {
          name: "Oregon",
          y: 1310047,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 811677,
          color: "#6a041d",
        },
        {
          name: "Florida",
          y: 337148,
          color: "#6a041d",
        },
        {
          name: "Maine",
          y: 264818,
          color: "#6a041d",
        },
        {
          name: "Connecticut",
          y: 195861,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Fuel Ethanol",
      id: "fuelEthanol",
      data: [
        {
          name: "Iowa",
          y: 112481227,
          color: "#6a041d",
        },
        {
          name: "Minnesota",
          y: 97058216,
          color: "#6a041d",
        },
        {
          name: "North Dakota",
          y: 85508229,
          color: "#6a041d",
        },
        {
          name: "Wisconsin",
          y: 83812720,
          color: "#6a041d",
        },
        {
          name: "South Dakota",
          y: 53575175,
          color: "#6a041d",
        },
        {
          name: "Kansas",
          y: 25168886,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 10839699,
          color: "#F5B841",
        },
        {
          name: "Maine",
          y: 1579080,
          color: "#6a041d",
        },
        {
          name: "Tennessee",
          y: 1422048,
          color: "#6a041d",
        },
        {
          name: "Nebraska",
          y: 649451,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Natural Gas",
      id: "naturalGas",
      data: [
        {
          name: "Michigan",
          y: 598492325,
          color: "#6a041d",
        },
        {
          name: "New York",
          y: 347260227,
          color: "#6a041d",
        },
        {
          name: "Maine",
          y: 203990700,
          color: "#6a041d",
        },
        {
          name: "Nebraska",
          y: 165592248,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 60001837,
          color: "#F5B841",
        },
        {
          name: "Connecticut",
          y: 51210127,
          color: "#6a041d",
        },
        {
          name: "New Jersey",
          y: 21054421,
          color: "#6a041d",
        },
        {
          name: "New Hampshire",
          y: 10041498,
          color: "#6a041d",
        },
        {
          name: "Kansas",
          y: 6360091,
          color: "#6a041d",
        },
        {
          name: "North Dakota",
          y: 4157388,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "RPP",
      id: "rpp",
      data: [
        {
          name: "North Dakota",
          y: 1977317002,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 1610172187,
          color: "#F5B841",
        },
        {
          name: "Minnesota",
          y: 1189365180,
          color: "#6a041d",
        },
        {
          name: "Illinois",
          y: 974438595,
          color: "#6a041d",
        },
        {
          name: "Louisiana",
          y: 572755348,
          color: "#6a041d",
        },
        {
          name: "Washington",
          y: 365037131,
          color: "#6a041d",
        },
        {
          name: "California",
          y: 215056644,
          color: "#6a041d",
        },
        {
          name: "Ohio",
          y: 202597477,
          color: "#6a041d",
        },
        {
          name: "Pennsylvania",
          y: 186373874,
          color: "#6a041d",
        },
        {
          name: "Michigan",
          y: 131114017,
          color: "#6a041d",
        },
      ],
    },
    {
      name: "Uranium",
      id: "uranium",
      data: [
        {
          name: "Illinois",
          y: 224997330,
          color: "#6a041d",
        },
        {
          name: "Missouri",
          y: 29412008,
          color: "#6a041d",
        },
        {
          name: "Indiana",
          y: 22787709,
          color: "#6a041d",
        },
        {
          name: "Massachusetts",
          y: 19122873,
          color: "#6a041d",
        },
        {
          name: "Georgia",
          y: 2665091,
          color: "#6a041d",
        },
        {
          name: "New Jersey",
          y: 2089157,
          color: "#6a041d",
        },
        {
          name: "California",
          y: 1946682,
          color: "#6a041d",
        },
        {
          name: "Washington",
          y: 1106632,
          color: "#6a041d",
        },
        {
          name: "Florida",
          y: 1099849,
          color: "#6a041d",
        },
        {
          name: "Wyoming",
          y: 1078006,
          color: "#6a041d",
        },
        {
          name: "Texas",
          y: 115057,
          color: "#F5B841",
        },
      ],
    },
  ],
};

let titleImportExport = "Exports";
let stateName = data.name;
let stateData = data.exports;
let stateDrilldown = data.exportDrilldown;

Highcharts.chart("container", {
  chart: {
    type: "column",
  },
  title: {
    text: stateName + ` Commodity ${titleImportExport} to Canada 2020`,
  },
  subtitle: {
    text: "SUBTITLE GOES HERE",
  },
  credits: {
    enabled: true,
    text: "CSIS Energy Security Project",
  },
  legend: {
    enabled: false,
  },
  xAxis: { type: "category", crosshair: false },
  yAxis: {
    type: "logarithmic",
    title: {
      text: "US Dollars",
    },
    labels: {
      formatter: function () {
        if (this.value >= 1000000000) {
          return "$" + this.value / 1000000000 + "B";
        } else if (this.value >= 1000000) {
          return "$" + this.value / 1000000 + "M";
        } else if (this.value >= 1000) {
          return "$" + this.value / 1000 + "K";
        } else {
          return "$" + this.value;
        }
      },
    },
  },
  tooltip: {
    useHTML: true,
    borderColor: "#333",
    backgroundColor: "#fff",
    formatter: function () {
      const formatY = (yValue) => {
        let y = "";
        if (yValue >= 1000000000) {
          y = "$" + parseFloat((yValue / 1000000000).toFixed(2)) + "B";
          return y;
        } else if (yValue >= 1000000) {
          y = "$" + parseFloat((yValue / 1000000).toFixed(2)) + "M";
          return y;
        } else if (yValue >= 1000) {
          y = "$" + parseFloat((yValue / 1000).toFixed(2)) + "K";
          return y;
        } else {
          y = "$" + yValue;
          return y;
        }
      };
      let drilldownData = this.series.userOptions.data;
      let rankingValues = this.series.userOptions.rankingValues;
      let index = this.point.index;
      let isDrilldown = this.point.options.isDrilldown;

      if (isDrilldown === "False") {
        let yFormatted = formatY(this.point.y);
        return `<b>${this.point.name}</b><br><br><span>Export Total: ${yFormatted}</span><br><span>Ranking: ${rankingValues[index]}</span>`;
      } else {
        let drillDownID = this.series.userOptions.id;
        console.log(drillDownID);
        let drilldownIndex = stateData.data.findIndex(
          (x) => x.drilldown === drillDownID
        );
        console.log(drilldownIndex);
        console.log(stateData);
        let ranking;

        let yFormatted = formatY(this.point.y);

        if (drilldownData[index].name == data.name) {
          ranking = stateData.rankingValues[drilldownIndex];
        } else {
          ranking = index + 1;
        }
        return `<b>${this.point.name}</b><br><br><span>Export Total: ${yFormatted}</span><br><span>Ranking: ${ranking}</span>`;
      }
    },
  },
  plotOptions: {
    column: {
      pointPadding: 0.2,
      borderWidth: 0,
      colorByPoint: true,
    },
  },
  colors: [
    "#001219",
    "#005f73",
    "#0a9396",
    "#94d2bd",
    "#fdbf45",
    "#ee9b00",
    "#ca6702",
  ],
  series: [stateData],
  drilldown: {
    breadcrumbs: {
      position: {
        align: "left",
      },
    },
    series: stateDrilldown,
  },
});
